.. -*- coding: utf-8; mode: rst; -*-

.. index:: dell, linux

Dell Inspiron 3268(Ubuntu Linux 24.04LTS)3.5HDD1T→2.5SSD960Gコピー
===================================================================

2024年11月4日

用意するもの
------------

- USBメモリ。 Ubuntu Linux 24.04 LTS desktop は 5.8G あるのでそれ以上の容量のを用意します。
- SATA-USB変換ケーブル。 2.5SSD を USBにつなぐために使用します。 また、 DELL PC 本体に SATA ケーブル、電源ケーブルを繋いで一時的にドライブを増設してもOKです。

手順0 - HDDバックアップ
-----------------------

以下の手順をミスる等すると HDD の内容が消えてしまうので、 以下の手順を実行する前に HDD のバックアップを取ってください。

手順1 - Ubuntu Live 用 USBメモリ作成
------------------------------------
  
Ubuntu Linux 24.04 LTS の ISO イメージをダウンロードします。

「ブータブルUSB作成」でUSBメモリに書き込みます。

手順2 - Ubuntu Live 起動
------------------------

さて、ここで USBメモリから DELL PC を起動となる訳です。

ちょいとググると F2 を押しながら セットアップ画面に入って Boot Sequence をいじれだの F12 で Boot Select しろだの書いてあります。

が、

手元の DELL PC はこれを受け付けない状態です。そもそもどうやってセットアップ画面を出せばいいのか？

結論から言うと

USBメモリを挿入しておいてから、

.. code:: bash

   sudo systemctl reboot --firmware-setup

実行すると再起動してセットアップ画面が表示されるので、boot sequence の順番いじって usb メモリから起動するようにします。

手順3 - 3.5HDDパーティション縮小
--------------------------------

USBメモリから起動したら live で実行して、 gparted を実行し、 まずは 既存のHDD のパーティションを縮小します。
なぜならコピー先のSSDの方が容量が小さいからです。 コピー先の方が大きい場合はこの作業は必要ありませんが、
パーティション縮小しておいたほうがコピー時間が短くなります。たぶん。

resize します。 筆者のは78Gしか使用してなかったので、 縮小後のサイズは 100G としました。 apply すると実際に作業を開始します。

手元ではこの作業に2時間ぐらい掛かりました。 

そうしたら普通に立ち上げてみてパーティションのサイズを確認しましょう。 df とかで。小さくなってたら成功です。

手順4 - 3.5HDD → 2.5SSD コピー
-------------------------------

今度は SSDを USB-SATA変換ケーブルでUSBにつなぎ、USBメモリも挿して、再度上記のようにセットアップ画面を表示し、
boot sequence をいじって live で起動します。

再度 gparted を選んでパーティションのコピーを実行します。

必要な数だけ copy アンド paste を繰り返します。 コピー元のHDDでパーティションを copy します。
SSDに切り替えて paste します。
筆者の手元のでは UEFI パーティションと ext4 パーティション がありましたので
この作業を2回行いました。

その後 Apply を行うと実際に作業を開始します。数時間掛かります。

コピーが完了したら、電源を落として、
次のトピックの :ref:`dell-ssd` をご覧ください。 換装後立ち上げて正常に動けばOKです。

参考
----

- 3.5HDDのext4パーティションを縮小するのはこちらの記事を参考にさせていただきました(gparted の resize のところ)

  https://doredoko.hatenablog.com/entry/2024/06/15/075352

- 3.5HDDから2.5SDDへのコピーはこちらを参考にさせただきました(コピー先のパーティションサイズ拡大のところも)

  https://gihyo.jp/admin/serial/01/ubuntu-recipe/0645

